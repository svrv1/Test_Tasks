&НаСервере
Функция КоличествоДокументов(ИмяДокумента) Экспорт
     // Проверяем входной параметр
    Если ПустаяСтрока(ИмяДокумента) Тогда
        Сообщить("Имя документа не может быть пустым");
        Возврат 0;
    КонецЕсли;

    // Проверяем существование объекта метаданных
    ДанныеДокумента = Метаданные.Документы.Найти(ИмяДокумента);
    Если ДанныеДокумента = Неопределено Тогда
        Сообщить("Документ с указанным именем не найден в метаданных");
        Возврат 0;
    КонецЕсли;

    // Создаем объект запроса
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ
    |   КОЛИЧЕСТВО(Док.Ссылка) КАК Количество
    |ИЗ
    |   Документ." + ИмяДокумента + " КАК Док";

    // Выполняем запрос и получаем результат
    Результат = Запрос.Выполнить();
    Выборка = Результат.Выбрать();

    Если Выборка.Следующий() Тогда
        Возврат Выборка.Количество;
    КонецЕсли;

    Возврат 0;
КонецФункции
